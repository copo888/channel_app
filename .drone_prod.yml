---
kind: pipeline
type: docker
name: app-deploy

clone:
  disable: true

steps:
- name: slb-before-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: elk-host
    username: 
      from_secret: elk-user
    password:
      from_secret: elk-pwd
    port:
      from_secret: elk-port
    command_timeout: 180m
    script:
      - cd /home/aliyun_deploy
      - ./api01-before.sh
  when:
    ref:
      - refs/tags/api01-app*
      - refs/tags/api01-test*

- name: slb-before-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: elk-host
    username: 
      from_secret: elk-user
    password:
      from_secret: elk-pwd
    port:
      from_secret: elk-port
    command_timeout: 180m
    script:
      - cd /home/aliyun_deploy
      - ./api02-before.sh
  when:
    ref:
      - refs/tags/api02-app*
      - refs/tags/api02-test*

- name: docker-htpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f htpay/docker-compose.yml down
      - docker rmi htpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/htpay htpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t htpay -f htpay/Dockerfile .
      - docker-compose -f htpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apphtpay-*
      - refs/tags/api01-testhtpay-*
    status:
      - success

- name: docker-htpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f htpay/docker-compose.yml down
      - docker rmi htpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/htpay htpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t htpay -f htpay/Dockerfile .
      - docker-compose -f htpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apphtpay-*
      - refs/tags/api02-testhtpay-*
    status:
      - success

- name: docker-zhongshoupay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f zhongshoupay/docker-compose.yml down
      - docker rmi zhongshoupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/zhongshoupay zhongshoupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t zhongshoupay -f zhongshoupay/Dockerfile .
      - docker-compose -f zhongshoupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appzhongshoupay-*
      - refs/tags/api01-testzhongshoupay-*
    status:
      - success

- name: docker-zhongshoupay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f zhongshoupay/docker-compose.yml down
      - docker rmi zhongshoupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/zhongshoupay zhongshoupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t zhongshoupay -f zhongshoupay/Dockerfile .
      - docker-compose -f zhongshoupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appzhongshoupay-*
      - refs/tags/api02-testzhongshoupay-*
    status:
      - success

- name: docker-lepay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lepay/docker-compose.yml down
      - docker rmi lepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lepay lepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lepay -f lepay/Dockerfile .
      - docker-compose -f lepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-applepay-*
      - refs/tags/api01-testlepay-*
    status:
      - success

- name: docker-lepay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lepay/docker-compose.yml down
      - docker rmi lepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lepay lepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lepay -f lepay/Dockerfile .
      - docker-compose -f lepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-applepay-*
      - refs/tags/api02-testlepay-*
    status:
      - success

- name: docker-taotaopay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f taotaopay/docker-compose.yml down
      - docker rmi taotaopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/taotaopay taotaopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t taotaopay -f taotaopay/Dockerfile .
      - docker-compose -f taotaopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apptaotaopay-*
      - refs/tags/api01-testtaotaopay-*
    status:
      - success

- name: docker-taotaopay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f taotaopay/docker-compose.yml down
      - docker rmi taotaopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/taotaopay taotaopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t taotaopay -f taotaopay/Dockerfile .
      - docker-compose -f taotaopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apptaotaopay-*
      - refs/tags/api02-testtaotaopay-*
    status:
      - success

- name: docker-wanlisinpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wanlisinpay/docker-compose.yml down
      - docker rmi wanlisinpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wanlisinpay wanlisinpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wanlisinpay -f wanlisinpay/Dockerfile .
      - docker-compose -f wanlisinpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwanlisinpay-*
      - refs/tags/api01-testwanlisinpay-*
    status:
      - success

- name: docker-wanlisinpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wanlisinpay/docker-compose.yml down
      - docker rmi wanlisinpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wanlisinpay wanlisinpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wanlisinpay -f wanlisinpay/Dockerfile .
      - docker-compose -f wanlisinpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwanlisinpay-*
      - refs/tags/api02-testwanlisinpay-*
    status:
      - success

- name: docker-wangjhepay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wangjhepay/docker-compose.yml down
      - docker rmi wangjhepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wangjhepay wangjhepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wangjhepay -f wangjhepay/Dockerfile .
      - docker-compose -f wangjhepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwangjhepay-*
      - refs/tags/api01-testwangjhepay-*
    status:
      - success

- name: docker-wangjhepay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wangjhepay/docker-compose.yml down
      - docker rmi wangjhepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wangjhepay wangjhepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wangjhepay -f wangjhepay/Dockerfile .
      - docker-compose -f wangjhepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwangjhepay-*
      - refs/tags/api02-testwangjhepay-*
    status:
      - success

- name: docker-shenfutongpay6-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shenfutongpay6/docker-compose.yml down
      - docker rmi shenfutongpay6:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shenfutongpay6 shenfutongpay6/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shenfutongpay6 -f shenfutongpay6/Dockerfile .
      - docker-compose -f shenfutongpay6/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appshenfutongpay6-*
      - refs/tags/api01-testshenfutongpay6-*
    status:
      - success

- name: docker-shenfutongpay6-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shenfutongpay6/docker-compose.yml down
      - docker rmi shenfutongpay6:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shenfutongpay6 shenfutongpay6/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shenfutongpay6 -f shenfutongpay6/Dockerfile .
      - docker-compose -f shenfutongpay6/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appshenfutongpay6-*
      - refs/tags/api02-testshenfutongpay6-*
    status:
      - success

- name: docker-stpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f stpay/docker-compose.yml down
      - docker rmi stpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/stpay stpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t stpay -f stpay/Dockerfile .
      - docker-compose -f stpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appstpay-*
      - refs/tags/api01-teststpay-*
    status:
      - success

- name: docker-stpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f stpay/docker-compose.yml down
      - docker rmi stpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/stpay stpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t stpay -f stpay/Dockerfile .
      - docker-compose -f stpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appstpay-*
      - refs/tags/api02-teststpay-*
    status:
      - success

- name: docker-ailefupay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f ailefupay/docker-compose.yml down
      - docker rmi ailefupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/ailefupay ailefupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t ailefupay -f ailefupay/Dockerfile .
      - docker-compose -f ailefupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appailefupay-*
      - refs/tags/api01-testailefupay-*
    status:
      - success

- name: docker-ailefupay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f ailefupay/docker-compose.yml down
      - docker rmi ailefupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/ailefupay ailefupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t ailefupay -f ailefupay/Dockerfile .
      - docker-compose -f ailefupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appailefupay-*
      - refs/tags/api02-testailefupay-*
    status:
      - success

- name: docker-huanyupay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f huanyupay/docker-compose.yml down
      - docker rmi huanyupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/huanyupay huanyupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t huanyupay -f huanyupay/Dockerfile .
      - docker-compose -f huanyupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apphuanyupay-*
      - refs/tags/api01-testhuanyupay-*
    status:
      - success

- name: docker-huanyupay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f huanyupay/docker-compose.yml down
      - docker rmi huanyupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/huanyupay huanyupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t huanyupay -f huanyupay/Dockerfile .
      - docker-compose -f huanyupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apphuanyupay-*
      - refs/tags/api02-testhuanyupay-*
    status:
      - success

- name: docker-lyubupay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lyubupay/docker-compose.yml down
      - docker rmi lyubupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lyubupay lyubupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lyubupay -f lyubupay/Dockerfile .
      - docker-compose -f lyubupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-applyubupay-*
      - refs/tags/api01-testlyubupay-*
    status:
      - success

- name: docker-lyubupay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lyubupay/docker-compose.yml down
      - docker rmi lyubupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lyubupay lyubupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lyubupay -f lyubupay/Dockerfile .
      - docker-compose -f lyubupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-applyubupay-*
      - refs/tags/api02-testlyubupay-*
    status:
      - success

- name: docker-liepay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f liepay/docker-compose.yml down
      - docker rmi liepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/liepay liepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t liepay -f liepay/Dockerfile .
      - docker-compose -f liepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appliepay-*
      - refs/tags/api01-testliepay-*
    status:
      - success

- name: docker-liepay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f liepay/docker-compose.yml down
      - docker rmi liepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/liepay liepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t liepay -f liepay/Dockerfile .
      - docker-compose -f liepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appliepay-*
      - refs/tags/api02-testliepay-*
    status:
      - success

- name: docker-vcpay2-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f vcpay2/docker-compose.yml down
      - docker rmi vcpay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/vcpay2 vcpay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t vcpay2 -f vcpay2/Dockerfile .
      - docker-compose -f vcpay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appvcpay2-*
      - refs/tags/api01-testvcpay2-*
    status:
      - success

- name: docker-vcpay2-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f vcpay2/docker-compose.yml down
      - docker rmi vcpay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/vcpay2 vcpay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t vcpay2 -f vcpay2/Dockerfile .
      - docker-compose -f vcpay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appvcpay2-*
      - refs/tags/api02-testvcpay2-*
    status:
      - success

- name: docker-mlbproxypay2-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mlbproxypay2/docker-compose.yml down
      - docker rmi mlbproxypay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mlbproxypay2 mlbproxypay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mlbproxypay2 -f mlbproxypay2/Dockerfile .
      - docker-compose -f mlbproxypay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appmlbproxypay2-*
      - refs/tags/api01-testmlbproxypay2-*
    status:
      - success

- name: docker-mlbproxypay2-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mlbproxypay2/docker-compose.yml down
      - docker rmi mlbproxypay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mlbproxypay2 mlbproxypay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mlbproxypay2 -f mlbproxypay2/Dockerfile .
      - docker-compose -f mlbproxypay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appmlbproxypay2-*
      - refs/tags/api02-testmlbproxypay2-*
    status:
      - success

- name: docker-sinshangpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f sinshangpay/docker-compose.yml down
      - docker rmi sinshangpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/sinshangpay sinshangpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t sinshangpay -f sinshangpay/Dockerfile .
      - docker-compose -f sinshangpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appsinshangpay-*
      - refs/tags/api01-testsinshangpay-*
    status:
      - success

- name: docker-sinshangpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f sinshangpay/docker-compose.yml down
      - docker rmi sinshangpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/sinshangpay sinshangpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t sinshangpay -f sinshangpay/Dockerfile .
      - docker-compose -f sinshangpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appsinshangpay-*
      - refs/tags/api02-testsinshangpay-*
    status:
      - success

- name: docker-baisiangpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f baisiangpay/docker-compose.yml down
      - docker rmi baisiangpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/baisiangpay baisiangpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t baisiangpay -f baisiangpay/Dockerfile .
      - docker-compose -f baisiangpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appbaisiangpay-*
      - refs/tags/api01-testbaisiangpay-*
    status:
      - success

- name: docker-baisiangpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f baisiangpay/docker-compose.yml down
      - docker rmi baisiangpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/baisiangpay baisiangpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t baisiangpay -f baisiangpay/Dockerfile .
      - docker-compose -f baisiangpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appbaisiangpay-*
      - refs/tags/api02-testbaisiangpay-*
    status:
      - success

- name: docker-vp8pay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f vp8pay/docker-compose.yml down
      - docker rmi vp8pay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/vp8pay vp8pay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t vp8pay -f vp8pay/Dockerfile .
      - docker-compose -f vp8pay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appvp8pay-*
      - refs/tags/api01-testvp8pay-*
    status:
      - success

- name: docker-vp8pay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f vp8pay/docker-compose.yml down
      - docker rmi vp8pay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/vp8pay vp8pay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t vp8pay -f vp8pay/Dockerfile .
      - docker-compose -f vp8pay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appvp8pay-*
      - refs/tags/api02-testvp8pay-*
    status:
      - success

- name: docker-jstpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jstpay/docker-compose.yml down
      - docker rmi jstpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jstpay jstpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jstpay -f jstpay/Dockerfile .
      - docker-compose -f jstpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appjstpay-*
      - refs/tags/api01-testjstpay-*
    status:
      - success

- name: docker-jstpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jstpay/docker-compose.yml down
      - docker rmi jstpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jstpay jstpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jstpay -f jstpay/Dockerfile .
      - docker-compose -f jstpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appjstpay-*
      - refs/tags/api02-testjstpay-*
    status:
      - success

- name: docker-mlbpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mlbpay/docker-compose.yml down
      - docker rmi mlbpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mlbpay mlbpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mlbpay -f mlbpay/Dockerfile .
      - docker-compose -f mlbpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appmlbpay-*
      - refs/tags/api01-testmlbpay-*
    status:
      - success

- name: docker-mlbpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mlbpay/docker-compose.yml down
      - docker rmi mlbpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mlbpay mlbpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mlbpay -f mlbpay/Dockerfile .
      - docker-compose -f mlbpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appmlbpay-*
      - refs/tags/api02-testmlbpay-*
    status:
      - success

- name: docker-jindepay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jindepay/docker-compose.yml down
      - docker rmi jindepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jindepay jindepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jindepay -f jindepay/Dockerfile .
      - docker-compose -f jindepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appjindepay-*
      - refs/tags/api01-testjindepay-*
    status:
      - success

- name: docker-jindepay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jindepay/docker-compose.yml down
      - docker rmi jindepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jindepay jindepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jindepay -f jindepay/Dockerfile .
      - docker-compose -f jindepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appjindepay-*
      - refs/tags/api02-testjindepay-*
    status:
      - success

- name: docker-sandianlingpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f sandianlingpay/docker-compose.yml down
      - docker rmi sandianlingpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/sandianlingpay sandianlingpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t sandianlingpay -f sandianlingpay/Dockerfile .
      - docker-compose -f sandianlingpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appsandianlingpay-*
      - refs/tags/api01-testsandianlingpay-*
    status:
      - success

- name: docker-sandianlingpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f sandianlingpay/docker-compose.yml down
      - docker rmi sandianlingpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/sandianlingpay sandianlingpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t sandianlingpay -f sandianlingpay/Dockerfile .
      - docker-compose -f sandianlingpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appsandianlingpay-*
      - refs/tags/api02-testsandianlingpay-*
    status:
      - success

- name: docker-wtpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wtpay/docker-compose.yml down
      - docker rmi wtpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wtpay wtpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wtpay -f wtpay/Dockerfile .
      - docker-compose -f wtpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwtpay-*
      - refs/tags/api01-testwtpay-*
    status:
      - success

- name: docker-wtpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wtpay/docker-compose.yml down
      - docker rmi wtpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wtpay wtpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wtpay -f wtpay/Dockerfile .
      - docker-compose -f wtpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwtpay-*
      - refs/tags/api02-testwtpay-*
    status:
      - success

- name: docker-shahepay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shahepay/docker-compose.yml down
      - docker rmi shahepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shahepay shahepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shahepay -f shahepay/Dockerfile .
      - docker-compose -f shahepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appshahepay-*
      - refs/tags/api01-testshahepay-*
    status:
      - success

- name: docker-shahepay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shahepay/docker-compose.yml down
      - docker rmi shahepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shahepay shahepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shahepay -f shahepay/Dockerfile .
      - docker-compose -f shahepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appshahepay-*
      - refs/tags/api02-testshahepay-*
    status:
      - success

- name: docker-shandianpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shandianpay/docker-compose.yml down
      - docker rmi shandianpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shandianpay shandianpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shandianpay -f shandianpay/Dockerfile .
      - docker-compose -f shandianpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appshandianpay-*
      - refs/tags/api01-testshandianpay-*
    status:
      - success

- name: docker-shandianpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shandianpay/docker-compose.yml down
      - docker rmi shandianpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shandianpay shandianpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shandianpay -f shandianpay/Dockerfile .
      - docker-compose -f shandianpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appshandianpay-*
      - refs/tags/api02-testshandianpay-*
    status:
      - success

- name: docker-lelifupay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lelifupay/docker-compose.yml down
      - docker rmi lelifupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lelifupay lelifupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lelifupay -f lelifupay/Dockerfile .
      - docker-compose -f lelifupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-applelifupay-*
      - refs/tags/api01-testlelifupay-*
    status:
      - success

- name: docker-lelifupay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lelifupay/docker-compose.yml down
      - docker rmi lelifupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lelifupay lelifupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lelifupay -f lelifupay/Dockerfile .
      - docker-compose -f lelifupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-applelifupay-*
      - refs/tags/api02-testlelifupay-*
    status:
      - success

- name: docker-yunshengpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f yunshengpay/docker-compose.yml down
      - docker rmi yunshengpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/yunshengpay yunshengpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t yunshengpay -f yunshengpay/Dockerfile .
      - docker-compose -f yunshengpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appyunshengpay-*
      - refs/tags/api01-testyunshengpay-*
    status:
      - success

- name: docker-yunshengpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f yunshengpay/docker-compose.yml down
      - docker rmi yunshengpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/yunshengpay yunshengpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t yunshengpay -f yunshengpay/Dockerfile .
      - docker-compose -f yunshengpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appyunshengpay-*
      - refs/tags/api02-testyunshengpay-*
    status:
      - success

- name: docker-mashangpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mashangpay/docker-compose.yml down
      - docker rmi mashangpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mashangpay mashangpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mashangpay -f mashangpay/Dockerfile .
      - docker-compose -f mashangpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appmashangpay-*
      - refs/tags/api01-testmashangpay-*
    status:
      - success

- name: docker-mashangpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mashangpay/docker-compose.yml down
      - docker rmi mashangpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mashangpay mashangpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mashangpay -f mashangpay/Dockerfile .
      - docker-compose -f mashangpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appmashangpay-*
      - refs/tags/api02-testmashangpay-*
    status:
      - success

- name: docker-yibipay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f yibipay/docker-compose.yml down
      - docker rmi yibipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/yibipay yibipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t yibipay -f yibipay/Dockerfile .
      - docker-compose -f yibipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appyibipay-*
      - refs/tags/api01-testyibipay-*
    status:
      - success

- name: docker-yibipay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f yibipay/docker-compose.yml down
      - docker rmi yibipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/yibipay yibipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t yibipay -f yibipay/Dockerfile .
      - docker-compose -f yibipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appyibipay-*
      - refs/tags/api02-testyibipay-*
    status:
      - success

- name: docker-uzpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f uzpay/docker-compose.yml down
      - docker rmi uzpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/uzpay uzpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t uzpay -f uzpay/Dockerfile .
      - docker-compose -f uzpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appuzpay-*
      - refs/tags/api01-testuzpay-*
    status:
      - success

- name: docker-uzpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f uzpay/docker-compose.yml down
      - docker rmi uzpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/uzpay uzpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t uzpay -f uzpay/Dockerfile .
      - docker-compose -f uzpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appuzpay-*
      - refs/tags/api02-testuzpay-*
    status:
      - success

- name: docker-shenfutongpay7-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shenfutongpay7/docker-compose.yml down
      - docker rmi shenfutongpay7:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shenfutongpay7 shenfutongpay7/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shenfutongpay7 -f shenfutongpay7/Dockerfile .
      - docker-compose -f shenfutongpay7/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appshenfutongpay7-*
      - refs/tags/api01-testshenfutongpay7-*
    status:
      - success

- name: docker-shenfutongpay7-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shenfutongpay7/docker-compose.yml down
      - docker rmi shenfutongpay7:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shenfutongpay7 shenfutongpay7/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shenfutongpay7 -f shenfutongpay7/Dockerfile .
      - docker-compose -f shenfutongpay7/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appshenfutongpay7-*
      - refs/tags/api02-testshenfutongpay7-*
    status:
      - success

- name: docker-wangjhepay86-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wangjhepay86/docker-compose.yml down
      - docker rmi wangjhepay86:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wangjhepay86 wangjhepay86/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wangjhepay86 -f wangjhepay86/Dockerfile .
      - docker-compose -f wangjhepay86/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwangjhepay86-*
      - refs/tags/api01-testwangjhepay86-*
    status:
      - success

- name: docker-wangjhepay86-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wangjhepay86/docker-compose.yml down
      - docker rmi wangjhepay86:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wangjhepay86 wangjhepay86/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wangjhepay86 -f wangjhepay86/Dockerfile .
      - docker-compose -f wangjhepay86/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwangjhepay86-*
      - refs/tags/api02-testwangjhepay86-*
    status:
      - success

- name: docker-wangjhepay87-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wangjhepay87/docker-compose.yml down
      - docker rmi wangjhepay87:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wangjhepay87 wangjhepay87/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wangjhepay87 -f wangjhepay87/Dockerfile .
      - docker-compose -f wangjhepay87/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwangjhepay87-*
      - refs/tags/api01-testwangjhepay87-*
    status:
      - success

- name: docker-wangjhepay87-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wangjhepay87/docker-compose.yml down
      - docker rmi wangjhepay87:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wangjhepay87 wangjhepay87/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wangjhepay87 -f wangjhepay87/Dockerfile .
      - docker-compose -f wangjhepay87/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwangjhepay87-*
      - refs/tags/api02-testwangjhepay87-*
    status:
      - success

- name: docker-duotsaipay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f duotsaipay/docker-compose.yml down
      - docker rmi duotsaipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/duotsaipay duotsaipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t duotsaipay -f duotsaipay/Dockerfile .
      - docker-compose -f duotsaipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appduotsaipay-*
      - refs/tags/api01-testduotsaipay-*
    status:
      - success

- name: docker-duotsaipay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f duotsaipay/docker-compose.yml down
      - docker rmi duotsaipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/duotsaipay duotsaipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t duotsaipay -f duotsaipay/Dockerfile .
      - docker-compose -f duotsaipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appduotsaipay-*
      - refs/tags/api02-testduotsaipay-*
    status:
      - success

- name: docker-uzpay7777-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f uzpay7777/docker-compose.yml down
      - docker rmi uzpay7777:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/uzpay7777 uzpay7777/pay.go
      - DOCKER_BUILDKIT=1 docker build -t uzpay7777 -f uzpay7777/Dockerfile .
      - docker-compose -f uzpay7777/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appuzpay7777-*
      - refs/tags/api01-testuzpay7777-*
    status:
      - success

- name: docker-uzpay7777-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f uzpay7777/docker-compose.yml down
      - docker rmi uzpay7777:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/uzpay7777 uzpay7777/pay.go
      - DOCKER_BUILDKIT=1 docker build -t uzpay7777 -f uzpay7777/Dockerfile .
      - docker-compose -f uzpay7777/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appuzpay7777-*
      - refs/tags/api02-testuzpay7777-*
    status:
      - success

- name: docker-uzpay1881-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f uzpay1881/docker-compose.yml down
      - docker rmi uzpay1881:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/uzpay1881 uzpay1881/pay.go
      - DOCKER_BUILDKIT=1 docker build -t uzpay1881 -f uzpay1881/Dockerfile .
      - docker-compose -f uzpay1881/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appuzpay1881-*
      - refs/tags/api01-testuzpay1881-*
    status:
      - success

- name: docker-uzpay1881-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f uzpay1881/docker-compose.yml down
      - docker rmi uzpay1881:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/uzpay1881 uzpay1881/pay.go
      - DOCKER_BUILDKIT=1 docker build -t uzpay1881 -f uzpay1881/Dockerfile .
      - docker-compose -f uzpay1881/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appuzpay1881-*
      - refs/tags/api02-testuzpay1881-*
    status:
      - success

- name: docker-lyubupay2-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lyubupay2/docker-compose.yml down
      - docker rmi lyubupay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lyubupay2 lyubupay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lyubupay2 -f lyubupay2/Dockerfile .
      - docker-compose -f lyubupay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-applyubupay2-*
      - refs/tags/api01-testlyubupay2-*
    status:
      - success

- name: docker-lyubupay2-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lyubupay2/docker-compose.yml down
      - docker rmi lyubupay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lyubupay2 lyubupay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lyubupay2 -f lyubupay2/Dockerfile .
      - docker-compose -f lyubupay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-applyubupay2-*
      - refs/tags/api02-testlyubupay2-*
    status:
      - success

- name: docker-zhiyuanpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f zhiyuanpay/docker-compose.yml down
      - docker rmi zhiyuanpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/zhiyuanpay zhiyuanpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t zhiyuanpay -f zhiyuanpay/Dockerfile .
      - docker-compose -f zhiyuanpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appzhiyuanpay-*
      - refs/tags/api01-testzhiyuanpay-*
    status:
      - success

- name: docker-zhiyuanpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f zhiyuanpay/docker-compose.yml down
      - docker rmi zhiyuanpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/zhiyuanpay zhiyuanpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t zhiyuanpay -f zhiyuanpay/Dockerfile .
      - docker-compose -f zhiyuanpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appzhiyuanpay-*
      - refs/tags/api02-testzhiyuanpay-*
    status:
      - success

- name: docker-wangjhepay116-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wangjhepay116/docker-compose.yml down
      - docker rmi wangjhepay116:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wangjhepay116 wangjhepay116/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wangjhepay116 -f wangjhepay116/Dockerfile .
      - docker-compose -f wangjhepay116/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwangjhepay116-*
      - refs/tags/api01-testwangjhepay116-*
    status:
      - success

- name: docker-wangjhepay116-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wangjhepay116/docker-compose.yml down
      - docker rmi wangjhepay116:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wangjhepay116 wangjhepay116/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wangjhepay116 -f wangjhepay116/Dockerfile .
      - docker-compose -f wangjhepay116/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwangjhepay116-*
      - refs/tags/api02-testwangjhepay116-*
    status:
      - success

- name: docker-jstpay2-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jstpay2/docker-compose.yml down
      - docker rmi jstpay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jstpay2 jstpay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jstpay2 -f jstpay2/Dockerfile .
      - docker-compose -f jstpay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appjstpay2-*
      - refs/tags/api01-testjstpay2-*
    status:
      - success

- name: docker-jstpay2-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jstpay2/docker-compose.yml down
      - docker rmi jstpay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jstpay2 jstpay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jstpay2 -f jstpay2/Dockerfile .
      - docker-compose -f jstpay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appjstpay2-*
      - refs/tags/api02-testjstpay2-*
    status:
      - success

- name: docker-vp8pay2-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f vp8pay2/docker-compose.yml down
      - docker rmi vp8pay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/vp8pay2 vp8pay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t vp8pay2 -f vp8pay2/Dockerfile .
      - docker-compose -f vp8pay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appvp8pay2-*
      - refs/tags/api01-testvp8pay2-*
    status:
      - success

- name: docker-vp8pay2-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f vp8pay2/docker-compose.yml down
      - docker rmi vp8pay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/vp8pay2 vp8pay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t vp8pay2 -f vp8pay2/Dockerfile .
      - docker-compose -f vp8pay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appvp8pay2-*
      - refs/tags/api02-testvp8pay2-*
    status:
      - success

- name: docker-ipay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f ipay/docker-compose.yml down
      - docker rmi ipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/ipay ipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t ipay -f ipay/Dockerfile .
      - docker-compose -f ipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appipay-*
      - refs/tags/api01-testipay-*
    status:
      - success

- name: docker-ipay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f ipay/docker-compose.yml down
      - docker rmi ipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/ipay ipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t ipay -f ipay/Dockerfile .
      - docker-compose -f ipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appipay-*
      - refs/tags/api02-testipay-*
    status:
      - success

- name: docker-wulinpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wulinpay/docker-compose.yml down
      - docker rmi wulinpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wulinpay wulinpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wulinpay -f wulinpay/Dockerfile .
      - docker-compose -f wulinpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwulinpay-*
      - refs/tags/api01-testwulinpay-*
    status:
      - success

- name: docker-wulinpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wulinpay/docker-compose.yml down
      - docker rmi wulinpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wulinpay wulinpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wulinpay -f wulinpay/Dockerfile .
      - docker-compose -f wulinpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwulinpay-*
      - refs/tags/api02-testwulinpay-*
    status:
      - success

- name: docker-changshengpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f changshengpay/docker-compose.yml down
      - docker rmi changshengpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/changshengpay changshengpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t changshengpay -f changshengpay/Dockerfile .
      - docker-compose -f changshengpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appchangshengpay-*
      - refs/tags/api01-testchangshengpay-*
    status:
      - success

- name: docker-changshengpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f changshengpay/docker-compose.yml down
      - docker rmi changshengpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/changshengpay changshengpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t changshengpay -f changshengpay/Dockerfile .
      - docker-compose -f changshengpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appchangshengpay-*
      - refs/tags/api02-testchangshengpay-*
    status:
      - success

- name: docker-wanmahuipay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wanmahuipay/docker-compose.yml down
      - docker rmi wanmahuipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wanmahuipay wanmahuipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wanmahuipay -f wanmahuipay/Dockerfile .
      - docker-compose -f wanmahuipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwanmahuipay-*
      - refs/tags/api01-testwanmahuipay-*
    status:
      - success

- name: docker-wanmahuipay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wanmahuipay/docker-compose.yml down
      - docker rmi wanmahuipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wanmahuipay wanmahuipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wanmahuipay -f wanmahuipay/Dockerfile .
      - docker-compose -f wanmahuipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwanmahuipay-*
      - refs/tags/api02-testwanmahuipay-*
    status:
      - success

- name: docker-powerpay1881-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f powerpay1881/docker-compose.yml down
      - docker rmi powerpay1881:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/powerpay1881 powerpay1881/pay.go
      - DOCKER_BUILDKIT=1 docker build -t powerpay1881 -f powerpay1881/Dockerfile .
      - docker-compose -f powerpay1881/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apppowerpay1881-*
      - refs/tags/api01-testpowerpay1881-*
    status:
      - success

- name: docker-powerpay1881-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f powerpay1881/docker-compose.yml down
      - docker rmi powerpay1881:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/powerpay1881 powerpay1881/pay.go
      - DOCKER_BUILDKIT=1 docker build -t powerpay1881 -f powerpay1881/Dockerfile .
      - docker-compose -f powerpay1881/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apppowerpay1881-*
      - refs/tags/api02-testpowerpay1881-*
    status:
      - success

- name: docker-dpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f dpay/docker-compose.yml down
      - docker rmi dpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/dpay dpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t dpay -f dpay/Dockerfile .
      - docker-compose -f dpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appdpay-*
      - refs/tags/api01-testdpay-*
    status:
      - success

- name: docker-dpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f dpay/docker-compose.yml down
      - docker rmi dpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/dpay dpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t dpay -f dpay/Dockerfile .
      - docker-compose -f dpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appdpay-*
      - refs/tags/api02-testdpay-*
    status:
      - success

- name: docker-kumopay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopay/docker-compose.yml down
      - docker rmi kumopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopay kumopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopay -f kumopay/Dockerfile .
      - docker-compose -f kumopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appkumopay-*
      - refs/tags/api01-testkumopay-*
    status:
      - success

- name: docker-kumopay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopay/docker-compose.yml down
      - docker rmi kumopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopay kumopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopay -f kumopay/Dockerfile .
      - docker-compose -f kumopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appkumopay-*
      - refs/tags/api02-testkumopay-*
    status:
      - success

- name: docker-alogatewaypay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f alogatewaypay/docker-compose.yml down
      - docker rmi alogatewaypay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/alogatewaypay alogatewaypay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t alogatewaypay -f alogatewaypay/Dockerfile .
      - docker-compose -f alogatewaypay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appalogatewaypay-*
      - refs/tags/api01-testalogatewaypay-*
    status:
      - success

- name: docker-alogatewaypay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f alogatewaypay/docker-compose.yml down
      - docker rmi alogatewaypay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/alogatewaypay alogatewaypay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t alogatewaypay -f alogatewaypay/Dockerfile .
      - docker-compose -f alogatewaypay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appalogatewaypay-*
      - refs/tags/api02-testalogatewaypay-*
    status:
      - success

- name: docker-hueifutongpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f hueifutongpay/docker-compose.yml down
      - docker rmi hueifutongpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/hueifutongpay hueifutongpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t hueifutongpay -f hueifutongpay/Dockerfile .
      - docker-compose -f hueifutongpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apphueifutongpay-*
      - refs/tags/api01-testhueifutongpay-*
    status:
      - success

- name: docker-hueifutongpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f hueifutongpay/docker-compose.yml down
      - docker rmi hueifutongpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/hueifutongpay hueifutongpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t hueifutongpay -f hueifutongpay/Dockerfile .
      - docker-compose -f hueifutongpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apphueifutongpay-*
      - refs/tags/api02-testhueifutongpay-*
    status:
      - success

- name: docker-quickpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f quickpay/docker-compose.yml down
      - docker rmi quickpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/quickpay quickpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t quickpay -f quickpay/Dockerfile .
      - docker-compose -f quickpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appquickpay-*
      - refs/tags/api01-testquickpay-*
    status:
      - success

- name: docker-quickpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f quickpay/docker-compose.yml down
      - docker rmi quickpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/quickpay quickpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t quickpay -f quickpay/Dockerfile .
      - docker-compose -f quickpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appquickpay-*
      - refs/tags/api02-testquickpay-*
    status:
      - success

- name: docker-jioufupay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jioufupay/docker-compose.yml down
      - docker rmi jioufupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jioufupay jioufupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jioufupay -f jioufupay/Dockerfile .
      - docker-compose -f jioufupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appjioufupay-*
      - refs/tags/api01-testjioufupay-*
    status:
      - success

- name: docker-jioufupay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jioufupay/docker-compose.yml down
      - docker rmi jioufupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jioufupay jioufupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jioufupay -f jioufupay/Dockerfile .
      - docker-compose -f jioufupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appjioufupay-*
      - refs/tags/api02-testjioufupay-*
    status:
      - success

- name: docker-wgopay88-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wgopay88/docker-compose.yml down
      - docker rmi wgopay88:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wgopay88 wgopay88/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wgopay88 -f wgopay88/Dockerfile .
      - docker-compose -f wgopay88/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwgopay88-*
      - refs/tags/api01-testwgopay88-*
    status:
      - success

- name: docker-wgopay88-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wgopay88/docker-compose.yml down
      - docker rmi wgopay88:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wgopay88 wgopay88/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wgopay88 -f wgopay88/Dockerfile .
      - docker-compose -f wgopay88/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwgopay88-*
      - refs/tags/api02-testwgopay88-*
    status:
      - success

- name: docker-lanyunpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lanyunpay/docker-compose.yml down
      - docker rmi lanyunpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lanyunpay lanyunpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lanyunpay -f lanyunpay/Dockerfile .
      - docker-compose -f lanyunpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-applanyunpay-*
      - refs/tags/api01-testlanyunpay-*
    status:
      - success

- name: docker-lanyunpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f lanyunpay/docker-compose.yml down
      - docker rmi lanyunpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/lanyunpay lanyunpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t lanyunpay -f lanyunpay/Dockerfile .
      - docker-compose -f lanyunpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-applanyunpay-*
      - refs/tags/api02-testlanyunpay-*
    status:
      - success

- name: docker-limafupay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f limafupay/docker-compose.yml down
      - docker rmi limafupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/limafupay limafupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t limafupay -f limafupay/Dockerfile .
      - docker-compose -f limafupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-applimafupay-*
      - refs/tags/api01-testlimafupay-*
    status:
      - success

- name: docker-limafupay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f limafupay/docker-compose.yml down
      - docker rmi limafupay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/limafupay limafupay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t limafupay -f limafupay/Dockerfile .
      - docker-compose -f limafupay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-applimafupay-*
      - refs/tags/api02-testlimafupay-*
    status:
      - success

- name: docker-koreapay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f koreapay/docker-compose.yml down
      - docker rmi koreapay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/koreapay koreapay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t koreapay -f koreapay/Dockerfile .
      - docker-compose -f koreapay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appkoreapay-*
      - refs/tags/api01-testkoreapay-*
    status:
      - success

- name: docker-koreapay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f koreapay/docker-compose.yml down
      - docker rmi koreapay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/koreapay koreapay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t koreapay -f koreapay/Dockerfile .
      - docker-compose -f koreapay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appkoreapay-*
      - refs/tags/api02-testkoreapay-*
    status:
      - success

- name: docker-sinhongpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f sinhongpay/docker-compose.yml down
      - docker rmi sinhongpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/sinhongpay sinhongpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t sinhongpay -f sinhongpay/Dockerfile .
      - docker-compose -f sinhongpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appsinhongpay-*
      - refs/tags/api01-testsinhongpay-*
    status:
      - success

- name: docker-sinhongpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f sinhongpay/docker-compose.yml down
      - docker rmi sinhongpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/sinhongpay sinhongpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t sinhongpay -f sinhongpay/Dockerfile .
      - docker-compose -f sinhongpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appsinhongpay-*
      - refs/tags/api02-testsinhongpay-*
    status:
      - success

- name: docker-laikepay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f laikepay/docker-compose.yml down
      - docker rmi laikepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/laikepay laikepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t laikepay -f laikepay/Dockerfile .
      - docker-compose -f laikepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-applaikepay-*
      - refs/tags/api01-testlaikepay-*
    status:
      - success

- name: docker-laikepay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f laikepay/docker-compose.yml down
      - docker rmi laikepay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/laikepay laikepay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t laikepay -f laikepay/Dockerfile .
      - docker-compose -f laikepay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-applaikepay-*
      - refs/tags/api02-testlaikepay-*
    status:
      - success

- name: docker-quickpay_va-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f quickpay_va/docker-compose.yml down
      - docker rmi quickpay_va:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/quickpay_va quickpay_va/pay.go
      - DOCKER_BUILDKIT=1 docker build -t quickpay_va -f quickpay_va/Dockerfile .
      - docker-compose -f quickpay_va/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appquickpay_va-*
      - refs/tags/api01-testquickpay_va-*
    status:
      - success

- name: docker-quickpay_va-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f quickpay_va/docker-compose.yml down
      - docker rmi quickpay_va:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/quickpay_va quickpay_va/pay.go
      - DOCKER_BUILDKIT=1 docker build -t quickpay_va -f quickpay_va/Dockerfile .
      - docker-compose -f quickpay_va/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appquickpay_va-*
      - refs/tags/api02-testquickpay_va-*
    status:
      - success

- name: docker-kumopay1881-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopay1881/docker-compose.yml down
      - docker rmi kumopay1881:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopay1881 kumopay1881/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopay1881 -f kumopay1881/Dockerfile .
      - docker-compose -f kumopay1881/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appkumopay1881-*
      - refs/tags/api01-testkumopay1881-*
    status:
      - success

- name: docker-kumopay1881-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopay1881/docker-compose.yml down
      - docker rmi kumopay1881:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopay1881 kumopay1881/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopay1881 -f kumopay1881/Dockerfile .
      - docker-compose -f kumopay1881/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appkumopay1881-*
      - refs/tags/api02-testkumopay1881-*
    status:
      - success

- name: docker-kumopay1-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopay1/docker-compose.yml down
      - docker rmi kumopay1:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopay1 kumopay1/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopay1 -f kumopay1/Dockerfile .
      - docker-compose -f kumopay1/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appkumopay1-*
      - refs/tags/api01-testkumopay1-*
    status:
      - success

- name: docker-kumopay1-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopay1/docker-compose.yml down
      - docker rmi kumopay1:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopay1 kumopay1/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopay1 -f kumopay1/Dockerfile .
      - docker-compose -f kumopay1/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appkumopay1-*
      - refs/tags/api02-testkumopay1-*
    status:
      - success

- name: docker-budingpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f budingpay/docker-compose.yml down
      - docker rmi budingpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/budingpay budingpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t budingpay -f budingpay/Dockerfile .
      - docker-compose -f budingpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appbudingpay-*
      - refs/tags/api01-testbudingpay-*
    status:
      - success

- name: docker-budingpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f budingpay/docker-compose.yml down
      - docker rmi budingpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/budingpay budingpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t budingpay -f budingpay/Dockerfile .
      - docker-compose -f budingpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appbudingpay-*
      - refs/tags/api02-testbudingpay-*
    status:
      - success

- name: docker-zihyunpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f zihyunpay/docker-compose.yml down
      - docker rmi zihyunpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/zihyunpay zihyunpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t zihyunpay -f zihyunpay/Dockerfile .
      - docker-compose -f zihyunpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appzihyunpay-*
      - refs/tags/api01-testzihyunpay-*
    status:
      - success

- name: docker-zihyunpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f zihyunpay/docker-compose.yml down
      - docker rmi zihyunpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/zihyunpay zihyunpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t zihyunpay -f zihyunpay/Dockerfile .
      - docker-compose -f zihyunpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appzihyunpay-*
      - refs/tags/api02-testzihyunpay-*
    status:
      - success

- name: docker-mlbpay_php-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mlbpay_php/docker-compose.yml down
      - docker rmi mlbpay_php:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mlbpay_php mlbpay_php/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mlbpay_php -f mlbpay_php/Dockerfile .
      - docker-compose -f mlbpay_php/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appmlbpay_php-*
      - refs/tags/api01-testmlbpay_php-*
    status:
      - success

- name: docker-mlbpay_php-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mlbpay_php/docker-compose.yml down
      - docker rmi mlbpay_php:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mlbpay_php mlbpay_php/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mlbpay_php -f mlbpay_php/Dockerfile .
      - docker-compose -f mlbpay_php/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appmlbpay_php-*
      - refs/tags/api02-testmlbpay_php-*
    status:
      - success

- name: docker-yuehhaopay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f yuehhaopay/docker-compose.yml down
      - docker rmi yuehhaopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/yuehhaopay yuehhaopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t yuehhaopay -f yuehhaopay/Dockerfile .
      - docker-compose -f yuehhaopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appyuehhaopay-*
      - refs/tags/api01-testyuehhaopay-*
    status:
      - success

- name: docker-yuehhaopay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f yuehhaopay/docker-compose.yml down
      - docker rmi yuehhaopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/yuehhaopay yuehhaopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t yuehhaopay -f yuehhaopay/Dockerfile .
      - docker-compose -f yuehhaopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appyuehhaopay-*
      - refs/tags/api02-testyuehhaopay-*
    status:
      - success

- name: docker-feibaopay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f feibaopay/docker-compose.yml down
      - docker rmi feibaopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/feibaopay feibaopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t feibaopay -f feibaopay/Dockerfile .
      - docker-compose -f feibaopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appfeibaopay-*
      - refs/tags/api01-testfeibaopay-*
    status:
      - success

- name: docker-feibaopay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f feibaopay/docker-compose.yml down
      - docker rmi feibaopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/feibaopay feibaopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t feibaopay -f feibaopay/Dockerfile .
      - docker-compose -f feibaopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appfeibaopay-*
      - refs/tags/api02-testfeibaopay-*
    status:
      - success

- name: docker-rcpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f rcpay/docker-compose.yml down
      - docker rmi rcpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/rcpay rcpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t rcpay -f rcpay/Dockerfile .
      - docker-compose -f rcpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apprcpay-*
      - refs/tags/api01-testrcpay-*
    status:
      - success

- name: docker-rcpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f rcpay/docker-compose.yml down
      - docker rmi rcpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/rcpay rcpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t rcpay -f rcpay/Dockerfile .
      - docker-compose -f rcpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apprcpay-*
      - refs/tags/api02-testrcpay-*
    status:
      - success

- name: docker-rcpay_ue-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f rcpay_ue/docker-compose.yml down
      - docker rmi rcpay_ue:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/rcpay_ue rcpay_ue/pay.go
      - DOCKER_BUILDKIT=1 docker build -t rcpay_ue -f rcpay_ue/Dockerfile .
      - docker-compose -f rcpay_ue/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apprcpay_ue-*
      - refs/tags/api01-testrcpay_ue-*
    status:
      - success

- name: docker-rcpay_ue-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f rcpay_ue/docker-compose.yml down
      - docker rmi rcpay_ue:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/rcpay_ue rcpay_ue/pay.go
      - DOCKER_BUILDKIT=1 docker build -t rcpay_ue -f rcpay_ue/Dockerfile .
      - docker-compose -f rcpay_ue/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apprcpay_ue-*
      - refs/tags/api02-testrcpay_ue-*
    status:
      - success

- name: docker-mashangpay8888-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mashangpay8888/docker-compose.yml down
      - docker rmi mashangpay8888:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mashangpay8888 mashangpay8888/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mashangpay8888 -f mashangpay8888/Dockerfile .
      - docker-compose -f mashangpay8888/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appmashangpay8888-*
      - refs/tags/api01-testmashangpay8888-*
    status:
      - success

- name: docker-mashangpay8888-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f mashangpay8888/docker-compose.yml down
      - docker rmi mashangpay8888:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/mashangpay8888 mashangpay8888/pay.go
      - DOCKER_BUILDKIT=1 docker build -t mashangpay8888 -f mashangpay8888/Dockerfile .
      - docker-compose -f mashangpay8888/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appmashangpay8888-*
      - refs/tags/api02-testmashangpay8888-*
    status:
      - success

- name: docker-hueiyingpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f hueiyingpay/docker-compose.yml down
      - docker rmi hueiyingpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/hueiyingpay hueiyingpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t hueiyingpay -f hueiyingpay/Dockerfile .
      - docker-compose -f hueiyingpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apphueiyingpay-*
      - refs/tags/api01-testhueiyingpay-*
    status:
      - success

- name: docker-hueiyingpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f hueiyingpay/docker-compose.yml down
      - docker rmi hueiyingpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/hueiyingpay hueiyingpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t hueiyingpay -f hueiyingpay/Dockerfile .
      - docker-compose -f hueiyingpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apphueiyingpay-*
      - refs/tags/api02-testhueiyingpay-*
    status:
      - success

- name: docker-duomeipay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f duomeipay/docker-compose.yml down
      - docker rmi duomeipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/duomeipay duomeipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t duomeipay -f duomeipay/Dockerfile .
      - docker-compose -f duomeipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appduomeipay-*
      - refs/tags/api01-testduomeipay-*
    status:
      - success

- name: docker-duomeipay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f duomeipay/docker-compose.yml down
      - docker rmi duomeipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/duomeipay duomeipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t duomeipay -f duomeipay/Dockerfile .
      - docker-compose -f duomeipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appduomeipay-*
      - refs/tags/api02-testduomeipay-*
    status:
      - success

- name: docker-gtpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f gtpay/docker-compose.yml down
      - docker rmi gtpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/gtpay gtpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t gtpay -f gtpay/Dockerfile .
      - docker-compose -f gtpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appgtpay-*
      - refs/tags/api01-testgtpay-*
    status:
      - success

- name: docker-gtpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f gtpay/docker-compose.yml down
      - docker rmi gtpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/gtpay gtpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t gtpay -f gtpay/Dockerfile .
      - docker-compose -f gtpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appgtpay-*
      - refs/tags/api02-testgtpay-*
    status:
      - success

- name: docker-nyypay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f nyypay/docker-compose.yml down
      - docker rmi nyypay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/nyypay nyypay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t nyypay -f nyypay/Dockerfile .
      - docker-compose -f nyypay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appnyypay-*
      - refs/tags/api01-testnyypay-*
    status:
      - success

- name: docker-nyypay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f nyypay/docker-compose.yml down
      - docker rmi nyypay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/nyypay nyypay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t nyypay -f nyypay/Dockerfile .
      - docker-compose -f nyypay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appnyypay-*
      - refs/tags/api02-testnyypay-*
    status:
      - success

- name: docker-u2pay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f u2pay/docker-compose.yml down
      - docker rmi u2pay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/u2pay u2pay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t u2pay -f u2pay/Dockerfile .
      - docker-compose -f u2pay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appu2pay-*
      - refs/tags/api01-testu2pay-*
    status:
      - success

- name: docker-u2pay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f u2pay/docker-compose.yml down
      - docker rmi u2pay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/u2pay u2pay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t u2pay -f u2pay/Dockerfile .
      - docker-compose -f u2pay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appu2pay-*
      - refs/tags/api02-testu2pay-*
    status:
      - success

- name: docker-kumopaymaya-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopaymaya/docker-compose.yml down
      - docker rmi kumopaymaya:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopaymaya kumopaymaya/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopaymaya -f kumopaymaya/Dockerfile .
      - docker-compose -f kumopaymaya/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appkumopaymaya-*
      - refs/tags/api01-testkumopaymaya-*
    status:
      - success

- name: docker-kumopaymaya-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopaymaya/docker-compose.yml down
      - docker rmi kumopaymaya:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopaymaya kumopaymaya/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopaymaya -f kumopaymaya/Dockerfile .
      - docker-compose -f kumopaymaya/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appkumopaymaya-*
      - refs/tags/api02-testkumopaymaya-*
    status:
      - success

- name: docker-kumopay1111-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopay1111/docker-compose.yml down
      - docker rmi kumopay1111:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopay1111 kumopay1111/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopay1111 -f kumopay1111/Dockerfile .
      - docker-compose -f kumopay1111/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appkumopay1111-*
      - refs/tags/api01-testkumopay1111-*
    status:
      - success

- name: docker-kumopay1111-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kumopay1111/docker-compose.yml down
      - docker rmi kumopay1111:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kumopay1111 kumopay1111/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kumopay1111 -f kumopay1111/Dockerfile .
      - docker-compose -f kumopay1111/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appkumopay1111-*
      - refs/tags/api02-testkumopay1111-*
    status:
      - success

- name: docker-easypay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f easypay/docker-compose.yml down
      - docker rmi easypay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/easypay easypay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t easypay -f easypay/Dockerfile .
      - docker-compose -f easypay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appeasypay-*
      - refs/tags/api01-testeasypay-*
    status:
      - success

- name: docker-easypay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f easypay/docker-compose.yml down
      - docker rmi easypay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/easypay easypay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t easypay -f easypay/Dockerfile .
      - docker-compose -f easypay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appeasypay-*
      - refs/tags/api02-testeasypay-*
    status:
      - success

- name: docker-htpay2-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f htpay2/docker-compose.yml down
      - docker rmi htpay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/htpay2 htpay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t htpay2 -f htpay2/Dockerfile .
      - docker-compose -f htpay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apphtpay2-*
      - refs/tags/api01-testhtpay2-*
    status:
      - success

- name: docker-htpay2-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f htpay2/docker-compose.yml down
      - docker rmi htpay2:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/htpay2 htpay2/pay.go
      - DOCKER_BUILDKIT=1 docker build -t htpay2 -f htpay2/Dockerfile .
      - docker-compose -f htpay2/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apphtpay2-*
      - refs/tags/api02-testhtpay2-*
    status:
      - success

- name: docker-jindingpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jindingpay/docker-compose.yml down
      - docker rmi jindingpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jindingpay jindingpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jindingpay -f jindingpay/Dockerfile .
      - docker-compose -f jindingpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appjindingpay-*
      - refs/tags/api01-testjindingpay-*
    status:
      - success

- name: docker-jindingpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f jindingpay/docker-compose.yml down
      - docker rmi jindingpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/jindingpay jindingpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t jindingpay -f jindingpay/Dockerfile .
      - docker-compose -f jindingpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appjindingpay-*
      - refs/tags/api02-testjindingpay-*
    status:
      - success

- name: docker-qipay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f qipay/docker-compose.yml down
      - docker rmi qipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/qipay qipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t qipay -f qipay/Dockerfile .
      - docker-compose -f qipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appqipay-*
      - refs/tags/api01-testqipay-*
    status:
      - success

- name: docker-qipay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f qipay/docker-compose.yml down
      - docker rmi qipay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/qipay qipay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t qipay -f qipay/Dockerfile .
      - docker-compose -f qipay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appqipay-*
      - refs/tags/api02-testqipay-*
    status:
      - success

- name: docker-dbinpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f dbinpay/docker-compose.yml down
      - docker rmi dbinpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/dbinpay dbinpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t dbinpay -f dbinpay/Dockerfile .
      - docker-compose -f dbinpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appdbinpay-*
      - refs/tags/api01-testdbinpay-*
    status:
      - success

- name: docker-dbinpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f dbinpay/docker-compose.yml down
      - docker rmi dbinpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/dbinpay dbinpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t dbinpay -f dbinpay/Dockerfile .
      - docker-compose -f dbinpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appdbinpay-*
      - refs/tags/api02-testdbinpay-*
    status:
      - success

- name: docker-miduoduopay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f miduoduopay/docker-compose.yml down
      - docker rmi miduoduopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/miduoduopay miduoduopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t miduoduopay -f miduoduopay/Dockerfile .
      - docker-compose -f miduoduopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appmiduoduopay-*
      - refs/tags/api01-testmiduoduopay-*
    status:
      - success

- name: docker-miduoduopay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f miduoduopay/docker-compose.yml down
      - docker rmi miduoduopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/miduoduopay miduoduopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t miduoduopay -f miduoduopay/Dockerfile .
      - docker-compose -f miduoduopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appmiduoduopay-*
      - refs/tags/api02-testmiduoduopay-*
    status:
      - success

- name: docker-globalpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f globalpay/docker-compose.yml down
      - docker rmi globalpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/globalpay globalpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t globalpay -f globalpay/Dockerfile .
      - docker-compose -f globalpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appglobalpay-*
      - refs/tags/api01-testglobalpay-*
    status:
      - success

- name: docker-globalpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f globalpay/docker-compose.yml down
      - docker rmi globalpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/globalpay globalpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t globalpay -f globalpay/Dockerfile .
      - docker-compose -f globalpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appglobalpay-*
      - refs/tags/api02-testglobalpay-*
    status:
      - success

- name: docker-typay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f typay/docker-compose.yml down
      - docker rmi typay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/typay typay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t typay -f typay/Dockerfile .
      - docker-compose -f typay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apptypay-*
      - refs/tags/api01-testtypay-*
    status:
      - success

- name: docker-typay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f typay/docker-compose.yml down
      - docker rmi typay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/typay typay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t typay -f typay/Dockerfile .
      - docker-compose -f typay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apptypay-*
      - refs/tags/api02-testtypay-*
    status:
      - success

- name: docker-hqpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f hqpay/docker-compose.yml down
      - docker rmi hqpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/hqpay hqpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t hqpay -f hqpay/Dockerfile .
      - docker-compose -f hqpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apphqpay-*
      - refs/tags/api01-testhqpay-*
    status:
      - success

- name: docker-hqpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f hqpay/docker-compose.yml down
      - docker rmi hqpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/hqpay hqpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t hqpay -f hqpay/Dockerfile .
      - docker-compose -f hqpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apphqpay-*
      - refs/tags/api02-testhqpay-*
    status:
      - success

- name: docker-shtpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shtpay/docker-compose.yml down
      - docker rmi shtpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shtpay shtpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shtpay -f shtpay/Dockerfile .
      - docker-compose -f shtpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appshtpay-*
      - refs/tags/api01-testshtpay-*
    status:
      - success

- name: docker-shtpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f shtpay/docker-compose.yml down
      - docker rmi shtpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/shtpay shtpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t shtpay -f shtpay/Dockerfile .
      - docker-compose -f shtpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appshtpay-*
      - refs/tags/api02-testshtpay-*
    status:
      - success

- name: docker-tiansiapay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f tiansiapay/docker-compose.yml down
      - docker rmi tiansiapay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/tiansiapay tiansiapay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t tiansiapay -f tiansiapay/Dockerfile .
      - docker-compose -f tiansiapay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apptiansiapay-*
      - refs/tags/api01-testtiansiapay-*
    status:
      - success

- name: docker-tiansiapay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f tiansiapay/docker-compose.yml down
      - docker rmi tiansiapay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/tiansiapay tiansiapay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t tiansiapay -f tiansiapay/Dockerfile .
      - docker-compose -f tiansiapay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apptiansiapay-*
      - refs/tags/api02-testtiansiapay-*
    status:
      - success

- name: docker-txpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f txpay/docker-compose.yml down
      - docker rmi txpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/txpay txpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t txpay -f txpay/Dockerfile .
      - docker-compose -f txpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-apptxpay-*
      - refs/tags/api01-testtxpay-*
    status:
      - success

- name: docker-txpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f txpay/docker-compose.yml down
      - docker rmi txpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/txpay txpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t txpay -f txpay/Dockerfile .
      - docker-compose -f txpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-apptxpay-*
      - refs/tags/api02-testtxpay-*
    status:
      - success

- name: docker-uhpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f uhpay/docker-compose.yml down
      - docker rmi uhpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/uhpay uhpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t uhpay -f uhpay/Dockerfile .
      - docker-compose -f uhpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appuhpay-*
      - refs/tags/api01-testuhpay-*
    status:
      - success

- name: docker-uhpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f uhpay/docker-compose.yml down
      - docker rmi uhpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/uhpay uhpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t uhpay -f uhpay/Dockerfile .
      - docker-compose -f uhpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appuhpay-*
      - refs/tags/api02-testuhpay-*
    status:
      - success

- name: docker-wgopay7777-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wgopay7777/docker-compose.yml down
      - docker rmi wgopay7777:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wgopay7777 wgopay7777/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wgopay7777 -f wgopay7777/Dockerfile .
      - docker-compose -f wgopay7777/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appwgopay7777-*
      - refs/tags/api01-testwgopay7777-*
    status:
      - success

- name: docker-wgopay7777-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f wgopay7777/docker-compose.yml down
      - docker rmi wgopay7777:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/wgopay7777 wgopay7777/pay.go
      - DOCKER_BUILDKIT=1 docker build -t wgopay7777 -f wgopay7777/Dockerfile .
      - docker-compose -f wgopay7777/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appwgopay7777-*
      - refs/tags/api02-testwgopay7777-*
    status:
      - success

- name: docker-newglobalpay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay/docker-compose.yml down
      - docker rmi newglobalpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay newglobalpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay -f newglobalpay/Dockerfile .
      - docker-compose -f newglobalpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appnewglobalpay-*
      - refs/tags/api01-testnewglobalpay-*
    status:
      - success

- name: docker-newglobalpay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay/docker-compose.yml down
      - docker rmi newglobalpay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay newglobalpay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay -f newglobalpay/Dockerfile .
      - docker-compose -f newglobalpay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appnewglobalpay-*
      - refs/tags/api02-testnewglobalpay-*
    status:
      - success

- name: docker-newglobalpay1-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay1/docker-compose.yml down
      - docker rmi newglobalpay1:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay1 newglobalpay1/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay1 -f newglobalpay1/Dockerfile .
      - docker-compose -f newglobalpay1/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appnewglobalpay1-*
      - refs/tags/api01-testnewglobalpay1-*
    status:
      - success

- name: docker-newglobalpay1-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay1/docker-compose.yml down
      - docker rmi newglobalpay1:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay1 newglobalpay1/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay1 -f newglobalpay1/Dockerfile .
      - docker-compose -f newglobalpay1/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appnewglobalpay1-*
      - refs/tags/api02-testnewglobalpay1-*
    status:
      - success

- name: docker-newglobalpay777-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay777/docker-compose.yml down
      - docker rmi newglobalpay777:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay777 newglobalpay777/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay777 -f newglobalpay777/Dockerfile .
      - docker-compose -f newglobalpay777/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appnewglobalpay777-*
      - refs/tags/api01-testnewglobalpay777-*
    status:
      - success

- name: docker-newglobalpay777-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay777/docker-compose.yml down
      - docker rmi newglobalpay777:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay777 newglobalpay777/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay777 -f newglobalpay777/Dockerfile .
      - docker-compose -f newglobalpay777/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appnewglobalpay777-*
      - refs/tags/api02-testnewglobalpay777-*
    status:
      - success

- name: docker-newglobalpay1111-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay1111/docker-compose.yml down
      - docker rmi newglobalpay1111:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay1111 newglobalpay1111/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay1111 -f newglobalpay1111/Dockerfile .
      - docker-compose -f newglobalpay1111/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appnewglobalpay1111-*
      - refs/tags/api01-testnewglobalpay1111-*
    status:
      - success

- name: docker-newglobalpay1111-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay1111/docker-compose.yml down
      - docker rmi newglobalpay1111:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay1111 newglobalpay1111/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay1111 -f newglobalpay1111/Dockerfile .
      - docker-compose -f newglobalpay1111/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appnewglobalpay1111-*
      - refs/tags/api02-testnewglobalpay1111-*
    status:
      - success

- name: docker-newglobalpay1881-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username: 
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay1881/docker-compose.yml down
      - docker rmi newglobalpay1881:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay1881 newglobalpay1881/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay1881 -f newglobalpay1881/Dockerfile .
      - docker-compose -f newglobalpay1881/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appnewglobalpay1881-*
      - refs/tags/api01-testnewglobalpay1881-*
    status:
      - success

- name: docker-newglobalpay1881-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username: 
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f newglobalpay1881/docker-compose.yml down
      - docker rmi newglobalpay1881:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/newglobalpay1881 newglobalpay1881/pay.go
      - DOCKER_BUILDKIT=1 docker build -t newglobalpay1881 -f newglobalpay1881/Dockerfile .
      - docker-compose -f newglobalpay1881/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appnewglobalpay1881-*
      - refs/tags/api02-testnewglobalpay1881-*
    status:
      - success

- name: docker-kaduoduopay-api01
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api01-host
    username:
      from_secret: api01-user
    password:
      from_secret: api01-pwd
    port:
      from_secret: api01-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kaduoduopay/docker-compose.yml down
      - docker rmi kaduoduopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kaduoduopay kaduoduopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kaduoduopay -f kaduoduopay/Dockerfile .
      - docker-compose -f kaduoduopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api01-appkaduoduopay-*
      - refs/tags/api01-testkaduoduopay-*
    status:
      - success

- name: docker-kaduoduopay-api02
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: api02-host
    username:
      from_secret: api02-user
    password:
      from_secret: api02-pwd
    port:
      from_secret: api02-port
    command_timeout: 180m
    script:
      - cd /root/channel_app
      - git checkout -- .
      - git pull origin master
      - go mod tidy
      - docker-compose -f kaduoduopay/docker-compose.yml down
      - docker rmi kaduoduopay:latest
      - docker image prune -f
      - CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags='-s -w' -o bin/kaduoduopay kaduoduopay/pay.go
      - DOCKER_BUILDKIT=1 docker build -t kaduoduopay -f kaduoduopay/Dockerfile .
      - docker-compose -f kaduoduopay/docker-compose.yml up -d
  when:
    ref:
      - refs/tags/api02-appkaduoduopay-*
      - refs/tags/api02-testkaduoduopay-*
    status:
      - success


- name: slb-after
  image: appleboy/drone-ssh
  settings:
    host:
      from_secret: elk-host
    username: 
      from_secret: elk-user
    password:
      from_secret: elk-pwd
    port:
      from_secret: elk-port
    command_timeout: 180m
    script:
      - cd /home/aliyun_deploy
      - ./api-after.sh
  when:
    ref:
      - refs/tags/api01-app*
      - refs/tags/api02-app*
      - refs/tags/api-bal*


